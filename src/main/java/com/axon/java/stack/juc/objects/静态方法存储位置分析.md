# ğŸ§  **é™æ€æ–¹æ³•å­˜å‚¨ä½ç½®åˆ†æ**

## ğŸ“ **ç­”æ¡ˆï¼šæ–¹æ³•åŒº/å…ƒç©ºé—´**

```java
private static void method(){} // å­—èŠ‚ç å­˜å‚¨åœ¨ï¼šæ–¹æ³•åŒº(JDK7-) / å…ƒç©ºé—´(JDK8+)
```

## ğŸ” **è¯¦ç»†åˆ†æ**

### **JDK 8+ å†…å­˜å¸ƒå±€**
```java
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            å…ƒç©ºé—´ (Metaspace)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ObjectTest.class å…ƒæ•°æ® {           â”‚
â”‚   âœ… method()å­—èŠ‚ç                   â”‚
â”‚   âœ… æ–¹æ³•ç­¾åä¿¡æ¯                    â”‚
â”‚   âœ… è®¿é—®ä¿®é¥°ç¬¦                      â”‚
â”‚   âœ… å¼‚å¸¸è¡¨                         â”‚
â”‚ }                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å †å†…å­˜ (Heap)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Classå¯¹è±¡åŒºåŸŸ {                      â”‚
â”‚   âŒ ä¸åŒ…å«æ–¹æ³•å­—èŠ‚ç                  â”‚
â”‚   âœ… é™æ€å­—æ®µå¼•ç”¨                     â”‚
â”‚   âœ… ç±»çš„è¿è¡Œæ—¶ä¿¡æ¯                   â”‚
â”‚ }                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **JDK 7åŠä¹‹å‰**
```java
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          æ°¸ä¹…ä»£ (PermGen)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… é™æ€æ–¹æ³•å­—èŠ‚ç                     â”‚
â”‚ âœ… é™æ€å­—æ®µå¼•ç”¨                      â”‚
â”‚ âœ… ç±»å…ƒæ•°æ®                         â”‚
â”‚ âœ… å¸¸é‡æ±                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§ª **éªŒè¯ä»£ç **

```java
import java.lang.reflect.Method;

public class StaticMethodLocationTest {
    
    private static void testMethod() {
        System.out.println("è¿™æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•");
    }
    
    private void instanceMethod() {
        System.out.println("è¿™æ˜¯ä¸€ä¸ªå®ä¾‹æ–¹æ³•");
    }
    
    public static void main(String[] args) throws Exception {
        // 1. è·å–ç±»çš„å…ƒæ•°æ®ä¿¡æ¯
        Class<?> clazz = StaticMethodLocationTest.class;
        System.out.println("Classå¯¹è±¡: " + clazz);
        System.out.println("Classå¯¹è±¡åœ°å€: " + System.identityHashCode(clazz));
        
        // 2. è·å–é™æ€æ–¹æ³•
        Method staticMethod = clazz.getDeclaredMethod("testMethod");
        System.out.println("\n=== é™æ€æ–¹æ³•ä¿¡æ¯ ===");
        System.out.println("æ–¹æ³•å: " + staticMethod.getName());
        System.out.println("æ˜¯å¦é™æ€: " + java.lang.reflect.Modifier.isStatic(staticMethod.getModifiers()));
        System.out.println("æ–¹æ³•å¯¹è±¡: " + staticMethod);
        
        // 3. è·å–å®ä¾‹æ–¹æ³•
        Method instanceMethod = clazz.getDeclaredMethod("instanceMethod");
        System.out.println("\n=== å®ä¾‹æ–¹æ³•ä¿¡æ¯ ===");
        System.out.println("æ–¹æ³•å: " + instanceMethod.getName());
        System.out.println("æ˜¯å¦é™æ€: " + java.lang.reflect.Modifier.isStatic(instanceMethod.getModifiers()));
        System.out.println("æ–¹æ³•å¯¹è±¡: " + instanceMethod);
        
        // 4. æŸ¥çœ‹JVMå†…å­˜ä¿¡æ¯
        printJVMInfo();
        
        // 5. æ‰§è¡Œæ–¹æ³•
        System.out.println("\n=== æ–¹æ³•æ‰§è¡Œ ===");
        staticMethod.invoke(null); // é™æ€æ–¹æ³•ä¸éœ€è¦å®ä¾‹
        
        StaticMethodLocationTest instance = new StaticMethodLocationTest();
        instanceMethod.invoke(instance); // å®ä¾‹æ–¹æ³•éœ€è¦å¯¹è±¡å®ä¾‹
    }
    
    public static void printJVMInfo() {
        System.out.println("\n=== JVMå†…å­˜ä¿¡æ¯ ===");
        Runtime runtime = Runtime.getRuntime();
        System.out.println("Javaç‰ˆæœ¬: " + System.getProperty("java.version"));
        System.out.println("JVMç‰ˆæœ¬: " + System.getProperty("java.vm.version"));
        System.out.println("å †å†…å­˜ä½¿ç”¨: " + (runtime.totalMemory() - runtime.freeMemory()) / 1024 / 1024 + "MB");
        
        // æŸ¥çœ‹ç±»åŠ è½½å™¨ä¿¡æ¯
        ClassLoader classLoader = StaticMethodLocationTest.class.getClassLoader();
        System.out.println("ç±»åŠ è½½å™¨: " + classLoader);
    }
}
```

## ğŸ“Š **æ–¹æ³•å­˜å‚¨å¯¹æ¯”è¡¨**

| æ–¹æ³•ç±»å‹ | JDK 7åŠä¹‹å‰ | JDK 8+ | æ‰§è¡Œæ—¶ |
|---------|------------|--------|--------|
| **é™æ€æ–¹æ³•** | æ–¹æ³•åŒº(PermGen) | å…ƒç©ºé—´(Metaspace) | ç›´æ¥ä»å…ƒç©ºé—´åŠ è½½æ‰§è¡Œ |
| **å®ä¾‹æ–¹æ³•** | æ–¹æ³•åŒº(PermGen) | å…ƒç©ºé—´(Metaspace) | é€šè¿‡å¯¹è±¡å¼•ç”¨æ‰§è¡Œ |
| **æ–¹æ³•å­—èŠ‚ç ** | PermGen | Metaspace | æ‰€æœ‰æ–¹æ³•å­—èŠ‚ç éƒ½åœ¨è¿™é‡Œ |

## ğŸ”§ **å†…å­˜åŒºåŸŸè¯¦è§£**

### **1ï¸âƒ£ å…ƒç©ºé—´ (Metaspace) - JDK 8+**
```java
å…ƒç©ºé—´å†…å®¹ {
    âœ… ç±»çš„å­—èŠ‚ç  (åŒ…æ‹¬é™æ€æ–¹æ³•)
    âœ… æ–¹æ³•å…ƒæ•°æ®
    âœ… å¸¸é‡æ± ä¿¡æ¯
    âœ… ç±»ç»“æ„ä¿¡æ¯
    âŒ ä¸åŒ…å«é™æ€å˜é‡çš„å€¼
}

ç‰¹ç‚¹:
- ä½¿ç”¨æœ¬åœ°å†…å­˜ï¼Œä¸å ç”¨å †ç©ºé—´
- è‡ªåŠ¨æ‰©å±•ï¼Œå‡å°‘OOMé£é™©
- æ›´é«˜æ•ˆçš„åƒåœ¾å›æ”¶
```

### **2ï¸âƒ£ å †å†…å­˜ä¸­çš„Classå¯¹è±¡**
```java
Classå¯¹è±¡å†…å®¹ {
    âœ… é™æ€å­—æ®µçš„å¼•ç”¨
    âœ… ç±»çš„è¿è¡Œæ—¶ä¿¡æ¯
    âœ… åå°„ç›¸å…³æ•°æ®
    âŒ ä¸åŒ…å«æ–¹æ³•å­—èŠ‚ç 
}
```

## âš¡ **å­—èŠ‚ç æŸ¥çœ‹å·¥å…·**

### **æŸ¥çœ‹æ–¹æ³•å­—èŠ‚ç **
```bash
# ç¼–è¯‘Javaæ–‡ä»¶
javac StaticMethodLocationTest.java

# æŸ¥çœ‹å­—èŠ‚ç 
javap -c StaticMethodLocationTest

# è¯¦ç»†ä¿¡æ¯
javap -v StaticMethodLocationTest
```

### **è¾“å‡ºç¤ºä¾‹**
```java
private static void testMethod();
  descriptor: ()V
  flags: ACC_PRIVATE, ACC_STATIC
  Code:
    stack=2, locals=0, args_size=0
       0: getstatic     #2    // Field java/lang/System.out:Ljava/io/PrintStream;
       3: ldc           #3    // String è¿™æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•
       5: invokevirtual #4    // Method java/io/PrintStream.println:(Ljava/lang/String;)V
       8: return
```

## ğŸ¯ **å…³é”®åŒºåˆ«æ€»ç»“**

### **é™æ€æ–¹æ³• vs é™æ€å­—æ®µ**
```java
class Example {
    private static String field = "value";    // å¼•ç”¨åœ¨å †ä¸­Classå¯¹è±¡
    private static void method() {}           // å­—èŠ‚ç åœ¨å…ƒç©ºé—´
}

å†…å­˜åˆ†å¸ƒ:
â”Œâ”€â”€â”€ å…ƒç©ºé—´ â”€â”€â”€â”    â”Œâ”€â”€â”€ å †å†…å­˜ â”€â”€â”€â”
â”‚ method()å­—èŠ‚ç  â”‚    â”‚ Classå¯¹è±¡    â”‚
â”‚             â”‚    â”‚ â”œâ”€ fieldå¼•ç”¨  â”‚
â”‚             â”‚    â”‚ â””â”€ "value"å¯¹è±¡â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ **æ€§èƒ½å½±å“**

### **1ï¸âƒ£ æ–¹æ³•è°ƒç”¨å¼€é”€**
```java
// é™æ€æ–¹æ³•è°ƒç”¨ - ç›´æ¥ä»å…ƒç©ºé—´åŠ è½½
StaticMethodLocationTest.testMethod();  // ä½å¼€é”€

// å®ä¾‹æ–¹æ³•è°ƒç”¨ - éœ€è¦å¯¹è±¡å¼•ç”¨
instance.instanceMethod();              // ç¨é«˜å¼€é”€
```

### **2ï¸âƒ£ å†…å­˜å ç”¨**
```java
- æ–¹æ³•å­—èŠ‚ç : åŠ è½½ä¸€æ¬¡ï¼Œæ‰€æœ‰å®ä¾‹å…±äº«
- æ‰§è¡Œæ ˆå¸§: æ¯æ¬¡è°ƒç”¨åˆ›å»ºï¼Œè°ƒç”¨ç»“æŸé”€æ¯
- å±€éƒ¨å˜é‡: å­˜å‚¨åœ¨æ ˆå¸§ä¸­
```

## ğŸ’¡ **æœ€ä½³å®è·µ**

1. **é™æ€æ–¹æ³•å­—èŠ‚ç åœ¨å…ƒç©ºé—´ï¼Œæ‰€æœ‰å®ä¾‹å…±äº«**
2. **é¿å…è¿‡åº¦ä½¿ç”¨åå°„è°ƒç”¨é™æ€æ–¹æ³•**
3. **åˆç†è®¾ç½®å…ƒç©ºé—´å¤§å°** (`-XX:MetaspaceSize`)
4. **ç›‘æ§å…ƒç©ºé—´ä½¿ç”¨æƒ…å†µ**

æ€»ç»“ï¼š**é™æ€æ–¹æ³•çš„å­—èŠ‚ç å­˜å‚¨åœ¨å…ƒç©ºé—´(JDK8+)æˆ–æ–¹æ³•åŒº(JDK7-)ä¸­**ï¼ğŸ¯