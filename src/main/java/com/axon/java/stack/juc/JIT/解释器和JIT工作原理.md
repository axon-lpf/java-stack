# ğŸ—ï¸ **JVMè§£é‡Šå™¨ä¸JITç¼–è¯‘å™¨æ·±åº¦è§£æ**

## ğŸ“‹ **æ ¸å¿ƒæ¦‚å¿µæ¦‚è¿°**

JVMæ‰§è¡Œå¼•æ“é‡‡ç”¨**æ··åˆæ¨¡å¼**ï¼Œç»“åˆäº†**è§£é‡Šå™¨ (Interpreter)** å’Œ**å³æ—¶ç¼–è¯‘å™¨ (JIT Compiler)** ä¸¤ç§æ‰§è¡Œæ–¹å¼ï¼Œä»¥å¹³è¡¡å¯åŠ¨é€Ÿåº¦å’Œè¿è¡Œæ€§èƒ½ã€‚

## ğŸ”„ **JVMæ‰§è¡Œå¼•æ“æ•´ä½“æ¶æ„å›¾**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    JVM æ‰§è¡Œå¼•æ“æ¶æ„                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                  Javaæºä»£ç å±‚                            â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  public class Example {                                 â”‚ â”‚
â”‚  â”‚      public int calculate(int x) {                      â”‚ â”‚
â”‚  â”‚          int result = 0;                                â”‚ â”‚
â”‚  â”‚          for (int i = 0; i < 10000; i++) {              â”‚ â”‚
â”‚  â”‚              result += x * i;                           â”‚ â”‚
â”‚  â”‚          }                                              â”‚ â”‚
â”‚  â”‚          return result;                                 â”‚ â”‚
â”‚  â”‚      }                                                  â”‚ â”‚
â”‚  â”‚  }                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“ javacç¼–è¯‘                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   å­—èŠ‚ç å±‚                               â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  0: iconst_0         // å°†å¸¸æ•°0å‹å…¥æ ˆ                    â”‚ â”‚
â”‚  â”‚  1: istore_2         // å­˜å‚¨åˆ°æœ¬åœ°å˜é‡2 (result)         â”‚ â”‚
â”‚  â”‚  2: iconst_0         // å°†å¸¸æ•°0å‹å…¥æ ˆ                    â”‚ â”‚
â”‚  â”‚  3: istore_3         // å­˜å‚¨åˆ°æœ¬åœ°å˜é‡3 (i)             â”‚ â”‚
â”‚  â”‚  4: iload_3          // åŠ è½½æœ¬åœ°å˜é‡3 (i)               â”‚ â”‚
â”‚  â”‚  5: sipush 10000     // å°†10000å‹å…¥æ ˆ                   â”‚ â”‚
â”‚  â”‚  8: if_icmpge 26     // å¦‚æœi>=10000è·³è½¬åˆ°26            â”‚ â”‚
â”‚  â”‚  11: iload_2         // åŠ è½½result                      â”‚ â”‚
â”‚  â”‚  12: iload_1         // åŠ è½½x                           â”‚ â”‚
â”‚  â”‚  13: iload_3         // åŠ è½½i                           â”‚ â”‚
â”‚  â”‚  14: imul            // x * i                           â”‚ â”‚
â”‚  â”‚  15: iadd            // result + (x * i)                â”‚ â”‚
â”‚  â”‚  16: istore_2        // å­˜å‚¨æ–°çš„result                  â”‚ â”‚
â”‚  â”‚  17: iinc 3, 1       // i++                             â”‚ â”‚
â”‚  â”‚  20: goto 4          // è·³å›å¾ªç¯å¼€å§‹                     â”‚ â”‚
â”‚  â”‚  23: iload_2         // åŠ è½½result                      â”‚ â”‚
â”‚  â”‚  24: ireturn         // è¿”å›result                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“ JVMæ‰§è¡Œ                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                  JVMæ‰§è¡Œå¼•æ“                             â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚   è§£é‡Šå™¨æ‰§è¡Œ     â”‚              â”‚   JITç¼–è¯‘å™¨      â”‚  â”‚ â”‚
â”‚  â”‚  â”‚   (Interpreter) â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   (C1/C2)       â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                â”‚              â”‚                  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ é€æ¡è§£é‡Šæ‰§è¡Œ   â”‚              â”‚ â€¢ çƒ­ç‚¹ä»£ç ç¼–è¯‘    â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ å¯åŠ¨å¿«       â”‚              â”‚ â€¢ é«˜åº¦ä¼˜åŒ–       â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ æ‰§è¡Œæ…¢       â”‚              â”‚ â€¢ ç¼–è¯‘å»¶è¿Ÿ       â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                â”‚              â”‚                  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â”‚å­—èŠ‚ç è§£é‡Šå™¨  â”‚ â”‚              â”‚ â”‚ C1ç¼–è¯‘å™¨      â”‚ â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â”‚é€æ¡ç¿»è¯‘æ‰§è¡Œ  â”‚ â”‚              â”‚ â”‚ (Client)      â”‚ â”‚  â”‚ â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚              â”‚ â”‚ å¿«é€Ÿç¼–è¯‘      â”‚ â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                â”‚              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                â”‚              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                â”‚              â”‚ â”‚ C2ç¼–è¯‘å™¨      â”‚ â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                â”‚              â”‚ â”‚ (Server)      â”‚ â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                â”‚              â”‚ â”‚ æ·±åº¦ä¼˜åŒ–      â”‚ â”‚  â”‚ â”‚
â”‚  â”‚  â”‚                â”‚              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   æœ¬æœºä»£ç æ‰§è¡Œ                           â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  æ±‡ç¼–æŒ‡ä»¤ (x86-64ç¤ºä¾‹):                                  â”‚ â”‚
â”‚  â”‚  mov    %rdi, %rax        // ç§»åŠ¨å‚æ•°xåˆ°rax               â”‚ â”‚
â”‚  â”‚  imul   $10000, %rax      // rax = x * 10000            â”‚ â”‚
â”‚  â”‚  imul   $4999, %rax       // è¿›ä¸€æ­¥ä¼˜åŒ–è®¡ç®—               â”‚ â”‚
â”‚  â”‚  sar    $1, %rax          // é™¤ä»¥2                       â”‚ â”‚
â”‚  â”‚  retq                     // è¿”å›ç»“æœ                     â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  ğŸ’¡ JITç¼–è¯‘åçš„ä»£ç æ¯”è§£é‡Šæ‰§è¡Œå¿«10-100å€                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” **è§£é‡Šå™¨å·¥ä½œåŸç†è¯¦è§£**

### **1. è§£é‡Šå™¨æ‰§è¡Œæµç¨‹**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è§£é‡Šå™¨æ‰§è¡Œæµç¨‹å›¾                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  å¼€å§‹æ‰§è¡Œæ–¹æ³•                                                â”‚
â”‚         â†“                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚  è·å–å­—èŠ‚ç æŒ‡ä»¤  â”‚                                        â”‚
â”‚  â”‚   (PCæŒ‡å‘)      â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚         â†“                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  è§£ææŒ‡ä»¤ç±»å‹    â”‚â”€â”€â”€â”€â†’â”‚      æŒ‡ä»¤åˆ†å‘è¡¨                   â”‚ â”‚
â”‚  â”‚                â”‚     â”‚                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ iconst_0  â†’ handleIConst0()     â”‚ â”‚
â”‚         â†“                â”‚ iload_1   â†’ handleILoad()       â”‚ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ iadd      â†’ handleIAdd()        â”‚ â”‚
â”‚  â”‚  æ‰§è¡Œå¯¹åº”æ“ä½œ    â”‚     â”‚ if_icmpge â†’ handleIfICmpGe()    â”‚ â”‚
â”‚  â”‚                â”‚     â”‚ ireturn   â†’ handleIReturn()     â”‚ â”‚
â”‚  â”‚ â€¢ æ ˆæ“ä½œ        â”‚     â”‚ ...       â†’ ...                 â”‚ â”‚
â”‚  â”‚ â€¢ æœ¬åœ°å˜é‡æ“ä½œ   â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”‚ â€¢ å¯¹è±¡æ“ä½œ      â”‚                                        â”‚
â”‚  â”‚ â€¢ æ§åˆ¶æµæ“ä½œ    â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚         â†“                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚  æ›´æ–°ç¨‹åºè®¡æ•°å™¨  â”‚                                        â”‚
â”‚  â”‚   (PC += n)     â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚         â†“                                                   â”‚
â”‚      æ˜¯å¦ç»“æŸ? â”€â”€â”€â”€â”€â”€â”€â”€Noâ”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚         â†“ Yes                 â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚                             â”‚
â”‚  â”‚   è¿”å›ç»“æœ      â”‚          â”‚                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚                             â”‚
â”‚                               â”‚                             â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚         â†“                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚   çƒ­ç‚¹æ£€æµ‹      â”‚                                        â”‚
â”‚  â”‚                â”‚                                        â”‚
â”‚  â”‚ è°ƒç”¨è®¡æ•° >= é˜ˆå€¼?                                        â”‚ â”‚
â”‚  â”‚         â†“ Yes                                           â”‚ â”‚
â”‚  â”‚ è§¦å‘JITç¼–è¯‘                                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **2. è§£é‡Šå™¨å®ç°æ¨¡æ‹Ÿ**

```java
// JVMè§£é‡Šå™¨æ ¸å¿ƒå®ç°æ¨¡æ‹Ÿ
public class BytecodeInterpreter {
    
    private byte[] bytecode;          // å­—èŠ‚ç æ•°ç»„
    private int pc;                   // ç¨‹åºè®¡æ•°å™¨
    private int[] localVariables;     // æœ¬åœ°å˜é‡è¡¨
    private Stack<Integer> operandStack; // æ“ä½œæ•°æ ˆ
    private int invocationCount = 0;  // è°ƒç”¨è®¡æ•°
    
    public BytecodeInterpreter(byte[] bytecode) {
        this.bytecode = bytecode;
        this.pc = 0;
        this.localVariables = new int[10];
        this.operandStack = new Stack<>();
    }
    
    /**
     * è§£é‡Šå™¨ä¸»æ‰§è¡Œå¾ªç¯
     */
    public int execute() {
        System.out.println("=== è§£é‡Šå™¨å¼€å§‹æ‰§è¡Œ ===");
        invocationCount++;
        
        while (pc < bytecode.length) {
            // 1. è·å–å½“å‰æŒ‡ä»¤
            int opcode = bytecode[pc] & 0xFF;
            System.out.println("PC=" + pc + ", æŒ‡ä»¤=" + getOpcodeName(opcode));
            
            // 2. çƒ­ç‚¹æ£€æµ‹
            if (shouldTriggerJIT()) {
                System.out.println("ğŸ”¥ è§¦å‘JITç¼–è¯‘ï¼");
                return executeCompiledCode();
            }
            
            // 3. æŒ‡ä»¤åˆ†å‘æ‰§è¡Œ
            switch (opcode) {
                case 0x03: // iconst_0
                    handleIConst0();
                    break;
                case 0x1A: // iload_0
                    handleILoad(0);
                    break;
                case 0x1B: // iload_1
                    handleILoad(1);
                    break;
                case 0x3B: // istore_0
                    handleIStore(0);
                    break;
                case 0x60: // iadd
                    handleIAdd();
                    break;
                case 0x68: // imul
                    handleIMul();
                    break;
                case 0xA2: // if_icmpge
                    handleIfICmpGe();
                    break;
                case 0xAC: // ireturn
                    return handleIReturn();
                default:
                    System.out.println("æœªçŸ¥æŒ‡ä»¤: " + opcode);
                    pc++;
                    break;
            }
        }
        
        return 0;
    }
    
    /**
     * æ¨¡æ‹Ÿå…·ä½“æŒ‡ä»¤çš„æ‰§è¡Œ
     */
    private void handleIConst0() {
        operandStack.push(0);
        pc++;
        System.out.println("  æ‰§è¡Œ: å°†å¸¸æ•°0å‹å…¥æ ˆ");
    }
    
    private void handleILoad(int index) {
        operandStack.push(localVariables[index]);
        pc++;
        System.out.println("  æ‰§è¡Œ: åŠ è½½æœ¬åœ°å˜é‡[" + index + "]=" + localVariables[index]);
    }
    
    private void handleIStore(int index) {
        localVariables[index] = operandStack.pop();
        pc++;
        System.out.println("  æ‰§è¡Œ: å­˜å‚¨åˆ°æœ¬åœ°å˜é‡[" + index + "]=" + localVariables[index]);
    }
    
    private void handleIAdd() {
        int b = operandStack.pop();
        int a = operandStack.pop();
        int result = a + b;
        operandStack.push(result);
        pc++;
        System.out.println("  æ‰§è¡Œ: " + a + " + " + b + " = " + result);
    }
    
    private void handleIMul() {
        int b = operandStack.pop();
        int a = operandStack.pop();
        int result = a * b;
        operandStack.push(result);
        pc++;
        System.out.println("  æ‰§è¡Œ: " + a + " * " + b + " = " + result);
    }
    
    private void handleIfICmpGe() {
        int b = operandStack.pop();
        int a = operandStack.pop();
        if (a >= b) {
            // è·³è½¬ (ç®€åŒ–å®ç°ï¼Œå®é™…éœ€è¦è¯»å–è·³è½¬åç§»)
            pc += 3; // å‡è®¾è·³è½¬åç§»
            System.out.println("  æ‰§è¡Œ: " + a + " >= " + b + " ä¸ºtrueï¼Œè·³è½¬");
        } else {
            pc += 3;
            System.out.println("  æ‰§è¡Œ: " + a + " >= " + b + " ä¸ºfalseï¼Œç»§ç»­");
        }
    }
    
    private int handleIReturn() {
        int result = operandStack.pop();
        System.out.println("  æ‰§è¡Œ: è¿”å›ç»“æœ " + result);
        return result;
    }
    
    /**
     * çƒ­ç‚¹æ£€æµ‹é€»è¾‘
     */
    private boolean shouldTriggerJIT() {
        // ç®€åŒ–çš„çƒ­ç‚¹æ£€æµ‹ï¼šè°ƒç”¨æ¬¡æ•°è¾¾åˆ°é˜ˆå€¼
        return invocationCount >= 10000; // -XX:CompileThresholdé»˜è®¤å€¼
    }
    
    /**
     * æ¨¡æ‹ŸJITç¼–è¯‘åçš„ä»£ç æ‰§è¡Œ
     */
    private int executeCompiledCode() {
        System.out.println("ğŸš€ æ‰§è¡ŒJITç¼–è¯‘åçš„æœ¬æœºä»£ç ");
        // æ¨¡æ‹Ÿç¼–è¯‘ä¼˜åŒ–åçš„é«˜æ•ˆæ‰§è¡Œ
        return 42; // å‡è®¾çš„ä¼˜åŒ–è®¡ç®—ç»“æœ
    }
    
    private String getOpcodeName(int opcode) {
        // ç®€åŒ–çš„æ“ä½œç åç§°æ˜ å°„
        switch (opcode) {
            case 0x03: return "iconst_0";
            case 0x1A: return "iload_0";
            case 0x60: return "iadd";
            case 0xAC: return "ireturn";
            default: return "unknown_" + opcode;
        }
    }
}
```

## ğŸš€ **JITç¼–è¯‘å™¨å·¥ä½œåŸç†**

### **JITç¼–è¯‘æµç¨‹å›¾**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    JITç¼–è¯‘å™¨å·¥ä½œæµç¨‹                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  çƒ­ç‚¹ä»£ç æ£€æµ‹                                                â”‚
â”‚         â†“                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚  C1ç¼–è¯‘å™¨       â”‚â”€â”€â”€â”€â†’ å¿«é€Ÿç¼–è¯‘ (1-2ms)                   â”‚
â”‚  â”‚  (Clientç¼–è¯‘å™¨)  â”‚     â€¢ åŸºç¡€ä¼˜åŒ–                         â”‚
â”‚  â”‚                â”‚     â€¢ å†…è”å°æ–¹æ³•                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â€¢ æ¶ˆé™¤ç©ºæ£€æŸ¥                      â”‚
â”‚         â†“                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚  æ€§èƒ½åˆ†ææ”¶é›†    â”‚                                        â”‚
â”‚  â”‚  (Profiling)   â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚         â†“                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚  C2ç¼–è¯‘å™¨       â”‚â”€â”€â”€â”€â†’ æ·±åº¦ä¼˜åŒ– (10-100ms)                â”‚
â”‚  â”‚  (Serverç¼–è¯‘å™¨)  â”‚     â€¢ å¾ªç¯ä¼˜åŒ–                         â”‚
â”‚  â”‚                â”‚     â€¢ å‘é‡åŒ–                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â€¢ é€ƒé€¸åˆ†æ                       â”‚
â”‚         â†“                â€¢ é”æ¶ˆé™¤                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚  æœ¬æœºä»£ç ç”Ÿæˆ    â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ **æ ¸å¿ƒæ€»ç»“**

### **âš¡ è§£é‡Šå™¨ç‰¹ç‚¹**
- **å¯åŠ¨å¿«**: æ— ç¼–è¯‘å»¶è¿Ÿï¼Œç«‹å³æ‰§è¡Œ
- **å†…å­˜çœ**: ä¸éœ€è¦å­˜å‚¨ç¼–è¯‘åçš„ä»£ç 
- **æ‰§è¡Œæ…¢**: æ¯æ¬¡éƒ½éœ€è¦è§£æå­—èŠ‚ç 

### **ğŸš€ JITç¼–è¯‘å™¨ç‰¹ç‚¹**
- **æ‰§è¡Œå¿«**: æœ¬æœºä»£ç æ€§èƒ½ä¼˜å¼‚
- **å¯åŠ¨æ…¢**: éœ€è¦ç¼–è¯‘æ—¶é—´
- **ä¼˜åŒ–å¼º**: åŸºäºè¿è¡Œæ—¶ä¿¡æ¯çš„æ·±åº¦ä¼˜åŒ–

### **ğŸ”„ æ··åˆæ‰§è¡Œæ¨¡å¼**
JVMæ™ºèƒ½ç»“åˆä¸¤è€…ä¼˜åŠ¿ï¼š
1. **å†·å¯åŠ¨**æ—¶ç”¨è§£é‡Šå™¨å¿«é€Ÿå“åº”
2. **çƒ­ç‚¹ä»£ç **ç”¨JITç¼–è¯‘å™¨é«˜æ•ˆæ‰§è¡Œ
3. **åˆ†å±‚ç¼–è¯‘**é€æ­¥æå‡æ€§èƒ½

è¿™ç§è®¾è®¡è®©Javaæ—¢æœ‰å¿«é€Ÿå¯åŠ¨çš„èƒ½åŠ›ï¼Œåˆæœ‰é«˜æ€§èƒ½è¿è¡Œçš„è¡¨ç°ï¼